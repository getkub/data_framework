# Data Samples & Simulation Framework

## Overview

The `samples/` directory contains **vendor-scoped data samples** used to simulate logs and events across operating systems, network devices, and cloud platforms.

The structure is intentionally **flat per vendor** to:
- Reduce directory sprawl
- Avoid constant refactoring as new event types are added
- Make it easy to discover and reference samples
- Support automation and programmatic loading

Each sample file represents **one logical event class or dataset**, described entirely by metadata inside the file.

---

## Directory Structure

```text
samples/
├── README.md
├── windows/
│   ├── eventcode_2624.yml
│   ├── eventcode_4624.yml
│   └── eventcode_4688.yml
├── cisco/
│   ├── asa_auth_success.yml
│   ├── asa_auth_failure.yml
│   └── ios_login.yml
├── juniper/
│   └── junos_auth.yml
├── fortinet/
│   └── fortigate_login.yml
└── aws/
    ├── cloudtrail_console_login.yml
    ├── cloudtrail_iam_change.yml
    └── vpc_flowlog_accept.yml
````

---

## Design Principles

* One directory per vendor or platform
* One YAML file per logical event dataset
* No subdirectories based on product, service, or event type
* Classification and filtering are handled via metadata inside the YAML files

---

## File Naming Convention

```text
<event_source>_<short_description>.yml
```

### Naming Rules

* Lowercase only
* Underscore (`_`) separated
* No vendor name in filename (vendor is defined by directory)
* Descriptive but concise

### Examples

* `eventcode_2624.yml`
* `asa_auth_success.yml`
* `cloudtrail_console_login.yml`
* `vpc_flowlog_accept.yml`

---

## Standard YAML Structure

Each `.yml` file is **self-describing** and follows a common structure to enable uniform simulation across vendors.

---

## Top-Level Metadata

```yaml
version: 1.0
vendor: windows
source: security
event_class: authentication
event_id: 2624
description: >
  Simulates Windows Security Event Code 2624
  representing various authentication scenarios.
```

### Metadata Field Definitions

| Field         | Description                                                    |
| ------------- | -------------------------------------------------------------- |
| `version`     | Sample schema version                                          |
| `vendor`      | Vendor or platform name                                        |
| `source`      | Log source (security, cloudtrail, asa, vpc_flowlog, etc.)      |
| `event_class` | High-level category (authentication, process, network, config) |
| `event_id`    | Vendor-specific identifier (optional)                          |
| `description` | Human-readable description                                     |

---

## Simulation Controls

```yaml
simulation:
  repeatable: true
  default_count: 10
  time_distribution:
    type: sequential
    interval_seconds: 5
```

This section controls how events are replayed or generated by simulation engines.

---

## Event Records

### Core Event Schema (Vendor-Agnostic)

```yaml
events:
  - timestamp: "2024-01-01T12:00:00Z"
    host:
      name: WIN-DC01
      ip: 10.0.0.5
    user:
      name: jdoe
      domain: CORP
    source:
      ip: 192.168.1.10
    outcome: success
```

### Vendor-Specific Extensions

Vendor-specific fields **must be nested** under the vendor name to avoid schema collisions.

```yaml
windows:
  event_code: 2624
  logon_type: 3
  authentication_package: NTLM
  status: 0x0
  sub_status: 0x0
```

---

## Full Example: Windows Event Sample

**File:** `samples/windows/eventcode_2624.yml`

```yaml
version: 1.0
vendor: windows
source: security
event_class: authentication
event_id: 2624
description: >
  Windows Event Code 2624 authentication events
  including successful and failed logons.

simulation:
  repeatable: true
  default_count: 5
  time_distribution:
    type: sequential
    interval_seconds: 10

events:
  - timestamp: "2024-01-01T12:00:00Z"
    host:
      name: WIN-DC01
      ip: 10.0.0.5
    user:
      name: jdoe
      domain: CORP
    source:
      ip: 192.168.1.10
    outcome: success
    windows:
      event_code: 2624
      logon_type: 3
      authentication_package: NTLM
      status: 0x0
      sub_status: 0x0

  - timestamp: "2024-01-01T12:01:00Z"
    host:
      name: WIN-DC01
      ip: 10.0.0.5
    user:
      name: attacker
      domain: CORP
    source:
      ip: 192.168.1.200
    outcome: failure
    windows:
      event_code: 2624
      logon_type: 3
      authentication_package: NTLM
      status: 0xC000006D
      sub_status: 0xC000006A
```

---

## AWS Example

**File:** `samples/aws/cloudtrail_console_login.yml`

```yaml
version: 1.0
vendor: aws
source: cloudtrail
event_class: authentication
description: >
  AWS CloudTrail ConsoleLogin events.

events:
  - timestamp: "2024-01-01T15:00:00Z"
    user:
      name: alice
      type: IAMUser
    source:
      ip: 203.0.113.45
    outcome: success
    aws:
      event_name: ConsoleLogin
      region: us-east-1
      mfa_used: true
```

---

## Schema Rules & Guarantees

* Flat directory structure per vendor
* Self-contained YAML files
* Common core schema across vendors
* Vendor-specific data always nested
* Supports on-prem, network, and cloud data equally

---

## Goals of This Framework

* Enable repeatable and realistic event simulations
* Provide consistent input for parsers and detection logic
* Support security testing, analytics validation, and demos
* Scale cleanly as new vendors and event types are added

---

## Future Enhancements

* Formal JSON/YAML schema validation
* MITRE ATT&CK tagging
* Event correlation and chaining
* Randomized field generation
* Scenario-based simulations
* Linting and validation tooling

